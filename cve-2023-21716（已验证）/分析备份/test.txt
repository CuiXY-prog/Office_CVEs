# 开启堆调试
gflags.exe -i WINWORD.exe +hpa +ust

# 堆越写异常堆栈
00 00af4a90 6a39a3ef     18385274 00007ff8 00af4b0c wwlib!PTLS7::FsUpdateFinitePage+0x7635a			# wwlib+2F0020
01 00af7968 6a39651c     18385248 00af7cdc 0005d400 wwlib!PTLS7::FsUpdateFinitePage+0x70674			# wwlib+2E6DA0
02 00af7f1c 6a6e05ac     18385248 00af7f5c 00000070 wwlib!PTLS7::FsUpdateFinitePage+0x6c7a1			# wwlib+2E62A3
03 00af836c 6a6dffb5     0000000c 18385248 18385270 wwlib!PTLS7::LsDestroyContext+0x246427			# wwlib+6303E7
04 00af85c0 6a23a593     0000000c 04012000 40280000 wwlib!PTLS7::LsDestroyContext+0x245e30
05 00af9eac 6a0f68ef     0000000c 00000000 04012000 wwlib!PTLS7::FsUpdateBottomlessPage+0x17494
06 00afa3d4 6a2554ed     00afacb0 00000001 00000000 wwlib!PTLS7::LsAssert+0x2bd1c
07 00afb7dc 6a253d3b     00afbb70 00afbb68 04012000 wwlib!PTLS7::FsUpdateBottomlessPage+0x323ee
08 00afb860 6ad5be52     00afbb70 00afbb68 04012000 wwlib!PTLS7::FsUpdateBottomlessPage+0x30c3c
09 00afcdec 6a4a2cad     00afcebc 00000824 00000000 wwlib!wdGetApplicationObject+0xdf8a0
0a 00aff360 6a0d5b93     003c11e2 00000233 25a9003c wwlib!PTLS7::LsDestroyContext+0x8b28
0b 00aff3a0 74fbd273     003c11e2 00000233 25a9003c wwlib!PTLS7::LsAssert+0xafc0
0c 00aff3cc 74f9e84a     6a0d5b4d 003c11e2 00000233 USER32!SetManipulationInputTarget+0x53
0d 00aff4b4 74f9ded7     6a0d5b4d 00000000 00000233 USER32!DispatchMessageW+0x8fa
0e 00aff4f0 71a8a580     6a0d5b4d 003c11e2 00000233 USER32!CallWindowProcW+0x97
0f 00aff570 71a8a1d6     00000233 25a9003c 00000000 Comctl32!DefSubclassProc+0x400
10 00aff590 688c48e3     003c11e2 00000233 25a9003c Comctl32!DefSubclassProc+0x56
11 00aff5d8 688c47cf     003c11e2 00000233 25a9003c mso40uiwin32client+0x248e3
12 00aff604 71a8a5f8     003c11e2 00000233 25a9003c mso40uiwin32client+0x247cf
13 00aff688 71a8a3a1     00000233 25a9003c 00000000 Comctl32!DefSubclassProc+0x478
14 00aff6e4 74fbd273     003c11e2 00000233 25a9003c Comctl32!DefSubclassProc+0x221
15 00aff710 74f9e84a     71a8a300 003c11e2 00000233 USER32!SetManipulationInputTarget+0x53
16 00aff7f8 74f9e1a4     71a8a300 00000000 00000233 USER32!DispatchMessageW+0x8fa
17 00aff86c 74f9df60     00935800 00aff888 6a12d35f USER32!DispatchMessageW+0x254
18 00aff878 6a12d35f     6b54ca30 00000000 00aff8a0 USER32!DispatchMessageW+0x10
19 00aff888 6a12d309     6b54ca30 00000000 003c11e2 wwlib!PTLS7::LsAssert+0x6278c
1a 00aff8a0 6a12ce19     00000001 7454a200 6a0b0000 wwlib!PTLS7::LsAssert+0x62736
1b 00aff8e0 6a12b8c7     6a0be8d4 00aff910 010f1762 wwlib!PTLS7::LsAssert+0x62246
1c 00aff8ec 010f1762     010f0000 00000000 00c4effb wwlib!PTLS7::LsAssert+0x60cf4
1d 00aff910 010f1194     010f0000 00000000 00c4effb winword+0x1762
1e 00aff95c 745462c4     00934000 745462a0 c7897c77 winword+0x1194
1f 00aff970 779b0609     00934000 c479bd03 00000000 KERNEL32!BaseThreadInitThunk+0x24
20 00aff9b8 779b05d4     ffffffff 779d2521 00000000 ntdll!__RtlUserThreadStart+0x2f
21 00aff9c8 00000000     010f1000 00934000 00000000 ntdll!_RtlUserThreadStart+0x1b

# 异常函数断点
bu wwlib+2E6DA0
	# 查看堆创建
	KERNELBASE!HeapCreate
bu wwlib+2EA3E4