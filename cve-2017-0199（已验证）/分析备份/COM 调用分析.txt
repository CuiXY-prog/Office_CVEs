# 漏洞发生现场溯源
	- 通过 StgCreateDocfile 进行溯源, 通过对 ole32!StgCreateDocfile 下断点, 溯源后的栈空间如下所示
		00 00eecba0 6a122ec8     00eecdfa 04001012 00000000 ole32!StgCreateDocfile
		01 00eecbb8 6a122e8e     00eecdfa 04001012 6b3029f8 wwlib!PTLS7::FsUpdateFinitePage+0x3914d
		02 00eed000 6ae9483f     0f0471a0 013f2230 00000000 wwlib!PTLS7::FsUpdateFinitePage+0x39113
		03 00eed018 6a4a394f     0f0471a0 0f082e40 00eed04c wwlib!wdGetApplicationObject+0x45828d
		04 00eed0ac 6a15dcd6     013f2230 0f0471a0 00000028 wwlib!PTLS7::LsDestroyContext+0x2497ca
		05 00ef22c0 6a15ff62     013f2230 00ef57f2 0000018a wwlib!PTLS7::FsUpdateFinitePage+0x73f5b
		06 00ef5188 6a15651c     013f2230 00ef54fc 00006c00 wwlib!PTLS7::FsUpdateFinitePage+0x761e7
		07 00ef573c 6a4a05ac     013f2230 00ef577c 00000200 wwlib!PTLS7::FsUpdateFinitePage+0x6c7a1
		08 00ef5b8c 6a49ffb5     0000000c 013f2230 013f2258 wwlib!PTLS7::LsDestroyContext+0x246427
		09 00ef5de0 69ffa593     0000000c 04032000 40080000 wwlib!PTLS7::LsDestroyContext+0x245e30
		0a 00ef76cc 69eb68ef     0000000c 00000000 04032000 wwlib!PTLS7::FsUpdateBottomlessPage+0x17494
		0b 00ef7bf4 6a0154ed     00ef84d0 00000001 00000000 wwlib!PTLS7::LsAssert+0x2bd1c
		0c 00ef8ffc 6a013d3b     00ef90fc 00ef90ec 04032000 wwlib!PTLS7::FsUpdateBottomlessPage+0x323ee
		0d 00ef9080 6a8e721e     00ef90fc 00ef90ec 04032000 wwlib!PTLS7::FsUpdateBottomlessPage+0x30c3c
		0e 00efb3c4 6a8e6f04     00000000 0ed10ca8 00000000 wwlib!wdCommandDispatch+0xf1fdd
		0f 00efbd0c 6a404dc6     6b30da08 00000000 00000000 wwlib!wdCommandDispatch+0xf1cc3
		10 00efbf68 69f12f43     00efedbc 084954bb 00000318 wwlib!PTLS7::LsDestroyContext+0x1aac41
		11 00efed9c 6a028d23     00efedbc 00000001 00000001 wwlib!PTLS7::LsAssert+0x88370
		12 00efee70 6a028bb0     fffffffe 00efeeb8 00000000 wwlib!PTLS7::FsUpdateBottomlessPage+0x45c24
		13 00efee88 6816fd68     6b33d8c8 11e06c28 11e06c30 wwlib!PTLS7::FsUpdateBottomlessPage+0x45ab1
		14 00efeeb0 6816fcfe     00000001 0848d090 6892e804 mso99Lwin32client+0xafd68
		15 00efeee8 68249c69     11dd6c08 0100004e 6892e804 mso99Lwin32client+0xafcfe
		16 00efef40 68109870     11dd6c08 0000004e 6892e804 mso99Lwin32client+0x189c69
		17 00efef64 680f40bb     11dd6c08 00000000 6892e804 mso99Lwin32client+0x49870
		18 00efef8c 680f3e1b     11dd6c08 0000004e 6892e804 mso99Lwin32client+0x340bb
		19 00efefb0 686bad2b     11dd6c08 0000004e 6892e804 mso99Lwin32client+0x33e1b
		1a 00efefe4 686bd9f4     11e06c58 11e07770 0b44c718 mso40uiwin32client+0x5ad2b
		1b 00efeff8 686b8243     11dd6c08 11e07770 0000004e mso40uiwin32client+0x5d9f4
		1c 00eff034 686b8199     11e07770 0000004e 11e06c58 mso40uiwin32client+0x58243
		1d 00eff058 686a8d57     11e1f000 6892e804 00000000 mso40uiwin32client+0x58199
		1e 00eff078 6868b5d6     11e1f000 6898bf84 6892e804 mso40uiwin32client+0x48d57
		1f 00eff0bc 6869be7b     0098bf84 00000002 6892e804 mso40uiwin32client+0x2b5d6
		20 00eff0e4 686fbea1     6898bf84 00000002 6892e804 mso40uiwin32client+0x3be7b
		21 00eff11c 687ac725     0b44bf50 6898bf84 00eff1a0 mso40uiwin32client+0x9bea1
		22 00eff13c 68707b6e     0ef5a700 00eff1a0 00000000 mso40uiwin32client+0x14c725
		23 00eff16c 6879efb7     0efc73b8 68941670 00eff1a0 mso40uiwin32client+0xa7b6e
		24 00eff1d0 68802ff8     00eff3fc 00eff3fc 00eff3d0 mso40uiwin32client+0x13efb7
		25 00eff1e4 686a5921     00eff3fc 00040000 00000000 mso40uiwin32client+0x1a2ff8
		26 00eff26c 6868160c     11d176b8 0efc73b8 00eff3d0 mso40uiwin32client+0x45921
		27 00eff2bc 686ade57     11d176b8 00eff3d0 00000000 mso40uiwin32client+0x2160c
		28 00eff398 686add55     11d176b8 00eff3d0 00000000 mso40uiwin32client+0x4de57
		29 00eff3b8 686a57cc     00eff3d0 00000001 0efc73b8 mso40uiwin32client+0x4dd55
		2a 00eff3e4 6875063d     00eff3fc 00000001 00000001 mso40uiwin32client+0x457cc
		2b 00eff428 68750736     0efc73b8 00eff454 0efc73b8 mso40uiwin32client+0xf063d
		2c 00eff470 6880309c     00eff49c 00000000 11df5820 mso40uiwin32client+0xf0736
		2d 00eff484 68724c4c     00eff49c 00040000 00000000 mso40uiwin32client+0x1a309c
		2e 00eff50c 6868160c     11d176b8 0efc73b8 11df5820 mso40uiwin32client+0xc4c4c
		2f 00eff55c 686ade57     11d176b8 11df5820 00000000 mso40uiwin32client+0x2160c
		30 00eff638 687095a2     11d176b8 11df5820 00000000 mso40uiwin32client+0x4de57
		31 00eff64c 686dba6f     11df57fc 00000000 00000000 mso40uiwin32client+0xa95a2
		32 00eff67c 68722243     11d176b8 0ee981a8 00c60061 mso40uiwin32client+0x7ba6f
		33 00eff6a0 686adb18     003317d0 0ee15c28 686ad77e mso40uiwin32client+0xc2243
		34 00eff74c 686ad7ea     00000202 00000000 00c60061 mso40uiwin32client+0x4db18
		35 00eff798 74fbd273     00000000 00000202 00000000 mso40uiwin32client+0x4d7ea
		36 00eff7c4 74f9e84a     686ad77e 003317d0 00000202 USER32!SetManipulationInputTarget+0x53
		37 00eff8ac 74f9e1a4     686ad77e 00000000 00000202 USER32!DispatchMessageW+0x8fa
		38 00eff920 74f9df60     00c77800 00eff93c 69eed35f USER32!DispatchMessageW+0x254
		39 00eff92c 69eed35f     6b30ca30 00000000 00eff954 USER32!DispatchMessageW+0x10
		3a 00eff93c 69eed309     6b30ca30 00000000 003317d0 wwlib!PTLS7::LsAssert+0x6278c
		3b 00eff954 69eece19     00000001 7454a200 69e70000 wwlib!PTLS7::LsAssert+0x62736
		3c 00eff994 69eeb8c7     69e7e8d4 00eff9c4 011e1762 wwlib!PTLS7::LsAssert+0x62246
		3d 00eff9a0 011e1762     011e0000 00000000 00fa370b wwlib!PTLS7::LsAssert+0x60cf4
		3e 00eff9c4 011e1194     011e0000 00000000 00fa370b winword+0x1762
		3f 00effa10 745462c4     00c76000 745462a0 23d04b8d winword+0x1194
		40 00effa24 779b0609     00c76000 202d5cdb 00000000 KERNEL32!BaseThreadInitThunk+0x24
		41 00effa6c 779b05d4     ffffffff 779d2534 00000000 ntdll!RtlSubscribeWnfStateChangeNotification+0x439
		42 00effa7c 00000000     011e1000 00c76000 00000000 ntdll!RtlSubscribeWnfStateChangeNotification+0x404

	- 返回 6a15dcd6 时函数被调用, 调用函数为 wwlib+2edcd1, 调用栈如下
	wwlib+2edcd1
		wwlilb+633c21
			wwlib+ca73b7: call    dword ptr [ecx+24h]  ds:002b:746196e8={ole32!CDefLink::BindToSource (746aab10)}












